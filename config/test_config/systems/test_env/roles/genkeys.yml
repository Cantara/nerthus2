name: Setup ssh keys
dependencies:
  - role: service
vars:
  service:
tasks:
  - block:
    - name: Create gredle directory if it does not exist
      ansible.builtin.file:
        path: "~/.ssh"
        state: directory
        mode: '0750'
    - name: generate SSH key
      openssh_keypair:
        path: "~/.ssh/id_rsa"
        type: rsa
        size: 4096
        state: present
        force: no
    become: yes
    become_user: "{{ service }}"